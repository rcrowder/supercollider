<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.44">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #902f20}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #45691f}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #062cb0}
p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #902f20; min-height: 12.0px}
span.s1 {color: #002ce2}
span.s2 {color: #062cb0}
span.s3 {color: #000000}
span.s4 {color: #45691f}
span.s5 {text-decoration: underline}
span.s6 {color: #606060}
span.s7 {color: #902f20}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>Scale</b></p>
<p class="p2"><br></p>
<p class="p3"><b>Inherits from: </b><a href="../Core/Object.html"><span class="s1"><b>Object</b></span></a><b><span class="Apple-converted-space"> </span></b></p>
<p class="p2"><br></p>
<p class="p3">Represents a musical scale. It supports arbitrary octave divisions and ratios, and (in conjunction with <a href="Tuning.html"><span class="s1"><b>Tuning</b></span></a><b> </b>) can generate pitch information in various ways, including as input to Patterns.</p>
<p class="p4"><br></p>
<p class="p5">a = <span class="s2">Scale</span>.major;</p>
<p class="p6"><span class="s3">a.degrees; <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// [ 0, 2, 4, 5, 7, 9, 11 ]</p>
<p class="p6"><span class="s3">a.semitones;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// [ 0, 2, 4, 5, 7, 9, 11 ]</p>
<p class="p6"><span class="s3">a.cents;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// [ 0, 200, 300, 500, 700, 900, 1100 ]</p>
<p class="p6"><span class="s3">a.ratios;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// [ 1, 1.1224620483089, 1.2599210498937, 1.3348398541685, etc. ]</p>
<p class="p2"><br></p>
<p class="p5"><span class="s2">Pbind</span>(<span class="s4">\scale</span>, a, <span class="s4">\degree</span>, <span class="s2">Pseq</span>((0..7) ++ (6..0) ++ [<span class="s4">\rest</span>], 1), <span class="s4">\dur</span>, 0.25).play;</p>
<p class="p2"><br></p>
<p class="p6">// use non-standard tuning</p>
<p class="p5">a.tuning_(<span class="s4">\just</span>);</p>
<p class="p6"><span class="s3">a.degrees;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// no change; degrees are independent of tuning</p>
<p class="p6"><span class="s3">a.semitones;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// [ 0, 2.0391000173077, 3.1564128700055, 4.9804499913461, etc. ]</p>
<p class="p6"><span class="s3">a.ratios.collect(</span><span class="s2">_</span><span class="s3">.round(0.001));<span class="Apple-tab-span">	</span></span>// [ 1, 1.125, 1.2, 1.333, 1.5, 1.667, 1.875 ]</p>
<p class="p2"><br></p>
<p class="p5"><span class="s2">Pbind</span>(<span class="s4">\scale</span>, a, <span class="s4">\degree</span>, <span class="s2">Pseq</span>((0..7) ++ (6..0) ++ [<span class="s4">\rest</span>], 1), <span class="s4">\dur</span>, 0.25).play;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p7"><b><span class="s5">Creation</span></b></p>
<p class="p2"><br></p>
<p class="p3"><b>*major, *minor, *dorian, *chromatic, *todi, *hijaz, *partch_o1, etc.</b></p>
<p class="p4"><br></p>
<p class="p3">Creates a scale from the library stored in <b>ScaleInfo</b>. Each scale comes with an appropriate default <b>Tuning</b>, but alternate tunings can be specified at creation time:</p>
<p class="p4"><br></p>
<p class="p8"><span class="s2">Scale</span><span class="s3">.phrygian(</span>\pythagorean<span class="s3">)</span></p>
<p class="p4"><br></p>
<p class="p3">If the tuning size does not match the scale's <b>pitchesPerOctave</b>, a warning will be thrown, and the scale will use its default tuning.</p>
<p class="p4"><br></p>
<p class="p3">For a complete list of available scales, execute</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.names</p>
<p class="p4"><br></p>
<p class="p3"><b>*choose(size, tuning)</b></p>
<p class="p4"><br></p>
<p class="p3">Creates a random scale from the library, constrained by size and tuning if desired.</p>
<p class="p4"><br></p>
<p class="p6"><span class="s2">Scale</span><span class="s3">.choose.name; </span>// could be anything</p>
<p class="p6"><span class="s2">Scale</span><span class="s3">.choose(7).name; </span>// will be a seven-note scale in a random tuning</p>
<p class="p6"><span class="s2">Scale</span><span class="s3">.choose(</span><span class="s2">nil</span><span class="s3">, </span><span class="s4">\et12</span><span class="s3">).name; </span>// will be a random scale in standard temperament</p>
<p class="p4"><br></p>
<p class="p3">Currently, if you specify both, you may get a mismatch, so<span class="Apple-converted-space"> </span></p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.choose(7).tuning_(<span class="s4">\et12</span>)</p>
<p class="p4"><br></p>
<p class="p3">is better than</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.choose(7, <span class="s4">\et12</span>)</p>
<p class="p2"><br></p>
<p class="p3"><b>*new(degrees, tuning, descDegrees)</b></p>
<p class="p4"><br></p>
<p class="p3">Creates a <b>Scale</b> from scratch. <b>degrees</b> should be an array of Integers or scale name. <b>tuning</b> can be an instance of <b>Tuning</b> or a symbol. Specify <b>descDegrees</b> if the Scale should play differently when descending than when ascending.</p>
<p class="p4"><br></p>
<p class="p2"><br></p>
<p class="p7"><b><span class="s5">Instance Methods</span></b></p>
<p class="p9"><br></p>
<p class="p3"><b>degrees_(degrees), descDegrees_(degrees)</b></p>
<p class="p4"><br></p>
<p class="p3">Sets the <b>degrees</b> or <b>descDegrees</b> of the Scale.<span class="Apple-converted-space">  </span><b>degrees</b> argument can be either an array of integers or a symbol matching a library scale.</p>
<p class="p4"><br></p>
<p class="p3"><b>tuning_(tuning)</b></p>
<p class="p4"><br></p>
<p class="p3">Sets the tuning of the Scale. <b>tuning</b> argument can be either an instance of <b>Tuning</b> or a symbol matching a library tuning.</p>
<p class="p4"><br></p>
<p class="p3"><b>scale_(degrees, tuning, descDegrees)</b></p>
<p class="p4"><br></p>
<p class="p3">Resets all elements of the scale.</p>
<p class="p4"><br></p>
<p class="p3"><b>semitones</b></p>
<p class="p4"><br></p>
<p class="p3">Returns a tuned array of semitone values. <b>asArray</b> is aliased to this method.</p>
<p class="p4"><br></p>
<p class="p3"><b>cents</b></p>
<p class="p4"><br></p>
<p class="p3">Returns a tuned array of cent values.</p>
<p class="p4"><br></p>
<p class="p3"><b>ratios</b></p>
<p class="p4"><br></p>
<p class="p3">Returns a tuned array of ratios.</p>
<p class="p4"><br></p>
<p class="p3"><b>asFloatArray</b></p>
<p class="p4"><br></p>
<p class="p3">Useful for server-side work.</p>
<p class="p4"><br></p>
<p class="p5">(</p>
<p class="p5"><span class="s2">var</span> scale, buffer;</p>
<p class="p5">scale = <span class="s2">Scale</span>.choose;</p>
<p class="p5">(<span class="s6">"scale chosen : "</span> ++ [scale.name, scale.tuning.name].asString).postln;</p>
<p class="p5">buffer = <span class="s2">Buffer</span>.alloc(s, scale.size,1, { <span class="s2">|b|</span> b.setnMsg(0, scale.asFloatArray) });</p>
<p class="p2"><br></p>
<p class="p5">r = play({</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span></span>SinOsc<span class="s3">.ar(</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>DegreeToKey<span class="s3">.kr(</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>buffer,</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s2">MouseX</span><span class="s3">.kr(0,15), </span>// mouse indexes into scale</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>scale.stepsPerOctave,</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>1, </span>// mul = 1</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>60 </span>// offset by 72 notes</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ </span><span class="s2">LFNoise1</span><span class="s3">.kr([3,3], 0.04) </span>// add some low freq stereo detuning</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>).midicps, </span>// convert midi notes to hertz</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.25</p>
<p class="p5"><span class="Apple-tab-span">	</span>)</p>
<p class="p5">})</p>
<p class="p5">)</p>
<p class="p4"><br></p>
<p class="p5">r.free;</p>
<p class="p4"><br></p>
<p class="p3"><b>size</b></p>
<p class="p4"><br></p>
<p class="p3">Returns the length of the scale.</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.ionian.size; <span class="s7">// 7</span></p>
<p class="p5"><span class="s2">Scale</span>.minorPentatonic.size; <span class="s7">// 5</span></p>
<p class="p5"><span class="s2">Scale</span>.ajam.size; <span class="s7">// 7</span></p>
<p class="p5"><span class="s2">Scale</span>.partch_o1.size; <span class="s7">// 6</span></p>
<p class="p4"><br></p>
<p class="p3"><b>pitchesPerOctave</b></p>
<p class="p4"><br></p>
<p class="p3">Returns the size of the pitch class set from which the tuning is drawn.</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.ionian.pitchesPerOctave; <span class="s7">// 12</span></p>
<p class="p5"><span class="s2">Scale</span>.minorPentatonic.pitchesPerOctave; <span class="s7">// 12</span></p>
<p class="p6"><span class="s2">Scale</span><span class="s3">.ajam.pitchesPerOctave; </span>// 24--this is a quarter-tone scale</p>
<p class="p5"><span class="s2">Scale</span>.partch_o1.pitchesPerOctave; <span class="s7">// 43</span></p>
<p class="p4"><br></p>
<p class="p3"><b>stepsPerOctave</b></p>
<p class="p4"><br></p>
<p class="p3">Usually 12, but may be different if the current tuning has a stretched or compressed octave. Needed for degreeToKey.</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.new((0..14), <span class="s4">\wcAlpha</span>).stepsPerOctave;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s7">// 11.7</span></p>
<p class="p5"><span class="s2">Scale</span>.new(#[0, 3, 6, 9, 12], <span class="s4">\bp</span>).stepsPerOctave;<span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span><span class="s7">//19.02</span></p>
<p class="p4"><br></p>
<p class="p3">but note:</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.ajam.stepsPerOctave; <span class="Apple-tab-span">	</span><span class="s7">// 12</span></p>
<p class="p4"><br></p>
<p class="p3"><b>at, wrapAt</b></p>
<p class="p4"><br></p>
<p class="p3">These access the array generated by semitones, with the additional feature that, if the previous access referenced a higher degree (pre-wrap), the descending form of the scale is used.</p>
<p class="p2"><br></p>
<p class="p5">a = <span class="s2">Scale</span>.melodicMinor;</p>
<p class="p5">a.wrapAt(4);<span class="Apple-converted-space">  </span><span class="s7">// 7</span></p>
<p class="p5">a.wrapAt(5);<span class="Apple-converted-space">  </span><span class="s7">// 9</span></p>
<p class="p5">a.wrapAt(6);<span class="Apple-converted-space">  </span><span class="s7">// 11</span></p>
<p class="p5">a.wrapAt(7);<span class="Apple-converted-space">  </span><span class="s7">// 0</span></p>
<p class="p5">a.wrapAt(6);<span class="Apple-converted-space">  </span><span class="s7">// 10</span></p>
<p class="p5">a.wrapAt(5);<span class="Apple-converted-space">  </span><span class="s7">// 8</span></p>
<p class="p2"><br></p>
<p class="p3"><b>name_</b></p>
<p class="p4"><br></p>
<p class="p3">Sets the name of the scale.</p>
<p class="p4"><br></p>
<p class="p3"><b>degreeToFreq(degree, rootFreq, octave)</b></p>
<p class="p4"><br></p>
<p class="p3">Returns a frequency based on current tuning and <b>rootFreq</b> argument.</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.major.degreeToFreq(2, 60.midicps, 1);<span class="Apple-converted-space">  <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s7">// 659.25511...</span></p>
<p class="p5"><span class="s2">Scale</span>.major(<span class="s4">\just</span>).degreeToFreq(2, 60.midicps, 1); <span class="Apple-tab-span">	</span><span class="s7">// 654.06391...</span></p>
<p class="p4"><br></p>
<p class="p3"><b>degreeToRatio(degree, octave)</b></p>
<p class="p4"><br></p>
<p class="p3">Returns a ratio based on current tuning.</p>
<p class="p4"><br></p>
<p class="p5"><span class="s2">Scale</span>.major.degreeToRatio(2, 1).round(0.001);<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s7">// 2.52</span></p>
<p class="p5"><span class="s2">Scale</span>.major(<span class="s4">\just</span>).degreeToRatio(2, 1).round(0.001);<span class="Apple-tab-span">	</span><span class="s7">// 2.5</span></p>
<p class="p11"><br></p>
<p class="p2"><br></p>
<p class="p7"><b><span class="s5">Examples</span></b></p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5">s.waitForBoot({</p>
<p class="p5"><span class="Apple-tab-span">	</span>a = <span class="s2">Scale</span>.ionian;</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>p = { <span class="s2">|scale|</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Pbind<span class="s3">(</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">\degree</span>, <span class="s2">Pseq</span>([0, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 0, <span class="s4">\rest</span>], <span class="s2">inf</span>),</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">\scale</span>, scale,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">\dur</span>, 0.25</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>).play;</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>q = p.value(a);</p>
<p class="p5">})</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p6">// change degrees</p>
<p class="p5">a.degrees_(<span class="s4">\phrygian</span>);</p>
<p class="p2"><br></p>
<p class="p6">// supports ascending/descending scales</p>
<p class="p5">a.degrees_(<span class="s4">\melodicMinor</span>);</p>
<p class="p6"><span class="s3">a.adDegrees; </span>// [ 0, 2, 3, 5, 7, 9, 11, 8, 7, 5, 3, 2, 0 ]</p>
<p class="p2"><br></p>
<p class="p5">a.degrees_(<span class="s4">\todi</span>);</p>
<p class="p5">a.descDegrees_(<span class="s4">\bartok</span>);</p>
<p class="p2"><br></p>
<p class="p6">// change tuning</p>
<p class="p5">a.tuning_(<span class="s4">\just</span>);</p>
<p class="p2"><br></p>
<p class="p6">// change all -- should be done simultaneously when switching</p>
<p class="p6">// number of steps per octave</p>
<p class="p5">a.scale_(<span class="s4">\bayati</span>, <span class="s4">\et24</span>);</p>
<p class="p2"><br></p>
<p class="p6">// ... but if you don't, we warn you and continue with</p>
<p class="p6">// default tuning</p>
<p class="p5">a.scale_(<span class="s4">\mixolydian</span>);</p>
<p class="p2"><br></p>
<p class="p6">// can also set tuning at creation time</p>
<p class="p5">(</p>
<p class="p5">q.stop;</p>
<p class="p5">a = <span class="s2">Scale</span>.ionian(<span class="s4">\pythagorean</span>);</p>
<p class="p5">q = p.value(a);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p6">// random scale</p>
<p class="p5">(</p>
<p class="p5">q.stop;</p>
<p class="p5">a = <span class="s2">Scale</span>.choose;</p>
<p class="p5">[a.name, a.tuning.name].postln;</p>
<p class="p5">q = p.value(a);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p6">// or constrain it by size or tuning</p>
<p class="p5">(</p>
<p class="p5">q.stop;</p>
<p class="p5">a = <span class="s2">Scale</span>.choose(7);</p>
<p class="p5">[a.name, a.tuning.name].postln;</p>
<p class="p5">q = p.value(a);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5">q.stop;</p>
<p class="p5">a = <span class="s2">Scale</span>.choose(<span class="s2">nil</span>, <span class="s4">\partch</span>);</p>
<p class="p5">[a.name, a.tuning.name].postln;</p>
<p class="p5">q = p.value(a);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p6">// or make up your own arbitrary scales and tunings</p>
<p class="p6">// degrees, tuning, descDegrees if different</p>
<p class="p5">a.scale_(</p>
<p class="p5"><span class="Apple-tab-span">	</span>#[0, 2, 4, 5, 7, 9, 10],</p>
<p class="p5"><span class="Apple-tab-span">	</span>[0, 0.8, 2.1, 3, 4.05, 5.2, 6, 6.75, 8.3, 9, 10.08, 11.5],<span class="Apple-converted-space"> </span></p>
<p class="p5"><span class="Apple-tab-span">	</span>#[0, 1, 4, 5, 7, 8, 11]</p>
<p class="p5">);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p8"><span class="s3">a.scale_(</span>\ionian<span class="s3">, </span>\sept2<span class="s3">, </span>\locrian<span class="s3">);</span></p>
<p class="p2"><br></p>
<p class="p6">// tuning has its own class</p>
<p class="p5">t = <span class="s2">Tuning</span>.werckmeister;</p>
<p class="p2"><br></p>
<p class="p5">a.scale_(<span class="s4">\lydian</span>, t);</p>
<p class="p2"><br></p>
<p class="p5">q.stop;</p>
<p class="p2"><br></p>
<p class="p6">// getting info</p>
<p class="p5">a.name;</p>
<p class="p5">a.degrees;</p>
<p class="p5">a.semitones;</p>
<p class="p5">a.ratios;<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p5">a.tuning.name;</p>
<p class="p5">a.tuning.semitones;</p>
<p class="p5">a.tuning.ratios;</p>
<p class="p2"><br></p>
<p class="p5"><span class="s2">Scale</span>.names;</p>
<p class="p5"><span class="s2">Tuning</span>.names;</p>
<p class="p2"><br></p>
<p class="p6">// cmd-J to see scale and tuning dictionaries in full</p>
<p class="p10">ScaleInfo</p>
<p class="p10">TuningInfo</p>
</body>
</html>
