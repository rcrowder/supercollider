<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.35">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0018ea}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; min-height: 16.0px}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #8b251b}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #000006; min-height: 14.0px}
p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0014bc}
p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #a91616}
p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #001db9}
p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #961e1e}
p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #000006}
p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco}
span.s1 {color: #000000}
span.s2 {color: #0d3be2}
span.s3 {color: #2059ed}
span.s4 {font: 12.0px Monaco}
span.s5 {color: #8b251b}
span.s6 {color: #0d3eed}
span.s7 {color: #000006}
span.s8 {color: #307109}
span.s9 {color: #0014bc}
span.s10 {color: #001afb}
span.s11 {font: 9.0px Monaco}
span.s12 {color: #a91616}
span.s13 {color: #1543e9}
span.s14 {color: #426f0e}
span.s15 {color: #001db9}
span.s16 {color: #961e1e}
span.s17 {font: 12.0px Helvetica}
span.s18 {color: #1039b6}
span.s19 {color: #002df4}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>Event</b></p>
<p class="p2"><br></p>
<p class="p3"><span class="s1"><b>Inherits from: </b><a href="../Core/Object.html"><b>Object</b></a><b> : </b><a href="Collection.html"><b>Collection</b></a><b> : </b><a href="Set.html"><b>Set</b></a><b> : </b><a href="Dictionary.html"><b>Dictionary</b></a><b> : </b><a href="IdentityDictionary.html"><b>IdentityDictionary</b></a><b> : </b><a href="Environment.html"><b>Environment</b></a></span></p>
<p class="p4"><b>Related classes: </b><a href="../Streams-Patterns-Events/Pattern.html"><span class="s2"><b>Pattern</b></span></a></p>
<p class="p5"><br></p>
<p class="p4">An Event is an Environment that specifies an action to be taken in response to a <b>play </b>message. The key/value pairs within the Event specify the parameters of that action.<span class="Apple-converted-space">  </span>Events may be also used for object prototyping. See <a href="Environment.html"><span class="s3">Environment</span></a> for more details.</p>
<p class="p2"><br></p>
<p class="p4">Event provides a <b>defaultParentEvent</b> that defines a variety of different event types and provides a complete set of default key/value pairs for each type. The type is determined by the value of the <span class="s4">key</span><b> \type</b><span class="s4"> </span>which defaults to <b>\note</b>.<span class="Apple-converted-space">  </span>Note events create synths on the server.</p>
<p class="p2"><br></p>
<p class="p4">Events can be written as a series of key value pairs enclosed in parentheses.<span class="Apple-converted-space">  </span>Empty parentheses will create an empty event.<span class="Apple-converted-space"> </span></p>
<p class="p6"><br></p>
<p class="p7"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(<span class="Apple-converted-space">  </span>).play;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// the default note</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(<span class="Apple-converted-space">  </span>freq: 500,<span class="Apple-converted-space">  </span>pan: -1) .play;<span class="Apple-tab-span">	</span><span class="s5">// 500 Hz, panned left</span></p>
<p class="p5"><br></p>
<p class="p10"><b>Class variables</b></p>
<p class="p2"><br></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>defaultParentEvent<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>the default event used in most cases</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>parentEvents<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>an IdentityDictionary of useful parent events</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>partialEvents<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>an IdentityDictionary of Events that define the default values and functions</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for different aspects of note generation (timing, volume, pitch, server to use, etc)</p>
<p class="p2"><br></p>
<p class="p10"><b>Creation / Class Methods</b></p>
<p class="p2"><br></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>*new(n, proto, parent, know = true)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>create an event</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>*default<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>returns an empty event with defaultParentEvent as parent</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>*silent (dur)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>returns an event that describes a pause</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>*addEventType(type, func)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Event types define alternate play functions that</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>are selected by the value of <b>~type</b></p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p4"><b>Methods</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>play<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>play the event</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>delta<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>returns a time delay until the next event in a sequence</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>next<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>used to enable events to be composed<span class="Apple-converted-space"> </span></p>
<p class="p4"><span class="Apple-tab-span">	</span><b>playAndDelta(cleanup, mute)<span class="Apple-tab-span">	</span></b>used by <a href="../Streams-Patterns-Events/EventStreamPlayer.html"><span class="s6">EventStreamPlayer</span></a> to play Events and obtain a time increment</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p4"><b>Methods that allow Events to provide user control for </b><a href="../ServerArchitecture/Synth.html"><span class="s6"><b>Synth</b></span></a><b>s on </b><a href="../ServerArchitecture/Group.html"><span class="s6"><b>Group</b></span></a><b>s</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>synth<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>makes the event a control interface to the resultant synth when played</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>group<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>makes the event a control interface to the resultant group when played<span class="Apple-converted-space"> </span></p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>stop<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>free the synth or group</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>pause<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>pause the synth or group</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>resume<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>resume the synth or group</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>release<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>release the synth or group</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>set<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>set a control value in the synth or group</p>
<p class="p5"><br></p>
<p class="p2"><br></p>
<p class="p10"><b>Events and SynthDefs</b></p>
<p class="p11"><br></p>
<p class="p4"><span class="s7">The key used to select what synthdef is to be played is </span><b>\instrument</b>.<span class="Apple-converted-space">  </span>In order to use a <a href="../ServerArchitecture/SynthDef.html"><span class="s6">SynthDef</span></a> with an Event, send it a <b>store</b><span class="s4"> </span>or <b>memStore</b> message.<span class="Apple-converted-space">  </span>This creates a description of the SynthDef that the event can consult to determine its control names. The values of these names in the event are used when the event is played. (See <a href="../ServerArchitecture/SynthDesc.html"><span class="s3">SynthDesc</span></a><b> </b>for details.)</p>
<p class="p2"><br></p>
<p class="p4"><b>.store</b> is more like .load -- it writes a .scsyndef file to disk and adds the SynthDef to the SynthDesc library.</p>
<p class="p4"><b>.memStore</b> is more like .send -- it sends the SynthDef over OSC and adds the SynthDef to the SynthDesc library.</p>
<p class="p2"><br></p>
<p class="p9">(</p>
<p class="p12">SynthDef<span class="s1">(</span><span class="s8">\pm</span><span class="s1">,{ </span>| out=0, freq=440, amp=0.1, pan=0, gate=1, ratio = 1, index = 1, ar = 0.1, dr = 0.1 |</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">var</span> z;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>z = <span class="s9">LPF</span>.ar(</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">PMOsc</span>.ar(freq, freq * ratio, <span class="s9">Linen</span>.kr(gate, ar,index, dr), 0, 0.3),</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">XLine</span>.kr(<span class="s9">Rand</span>(4000,5000), <span class="s9">Rand</span>(2500,3200), 1)</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>) * <span class="s9">Linen</span>.kr(gate, 0.01, 0.7, dr, 2);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">OffsetOut</span>.ar(out, <span class="s9">Pan2</span>.ar(z, pan, amp));</p>
<p class="p9">}).memStore</p>
<p class="p9">);</p>
<p class="p8"><br></p>
<p class="p9">(instrument: <span class="s8">\pm</span>).play;</p>
<p class="p8"><br></p>
<p class="p9">(instrument: <span class="s8">\pm</span>, ratio: 3.42, index: 12, freq: 150, ar: 8, dr: 3, sustain: 10).play;</p>
<p class="p6"><span class="Apple-tab-span">	</span></p>
<p class="p4"><b>note</b>: The use of <a href="../UGens/InOut/OffsetOut.html"><span class="s10">OffsetOut</span></a> in the SynthDef prevents irregularities that can result from the interaction of the timing of a sequence of notes and the control rate of the Server.</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p10"><b>Multi-channel Expansion</b><span class="s11"><span class="Apple-tab-span">	</span></span></p>
<p class="p8"><br></p>
<p class="p4">If a key relevant to the action is assigned an <a href="Array.html"><span class="s6">Array</span></a>, the action is repeated on each element of the array:</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9">( degree: (0..12)).play<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// a diatonic cluster</span></p>
<p class="p2"><br></p>
<p class="p4">If several keys are assigned arrays, the action is repeated for each element of the largest array.</p>
<p class="p4">Smaller arrays are rotated through repeatedly.<span class="Apple-converted-space">  </span>Here are some examples:</p>
<p class="p2"><br></p>
<p class="p13">// every other note of the diatonic cluster: stacked thirds</p>
<p class="p9">( degree: (0..12), amp: [0,0.1]).play</p>
<p class="p2"><br></p>
<p class="p13">// every other note of the semitone cluster: a wholetone cluster again</p>
<p class="p9">( note: (0..12), amp: [0,0.1]).play</p>
<p class="p2"><br></p>
<p class="p13">// every third note of the semitone cluster: a diminished chord</p>
<p class="p9">( note: (0..12), amp: [0,0, 0.1]).play</p>
<p class="p2"><br></p>
<p class="p10"><b>Arrayed Arguments</b><span class="s11"><span class="Apple-tab-span">	</span></span></p>
<p class="p8"><br></p>
<p class="p4">It is possible to assign an array to one of a <a href="../ServerArchitecture/SynthDef.html"><span class="s13">SynthDef</span></a>'s control names. For example:</p>
<p class="p2"><br></p>
<p class="p14">(</p>
<p class="p14">SynthDef<span class="s1">(</span><span class="s14">\test</span><span class="s1">, { </span>| out = 0, amp = 0.01, freq = #[300,400,400], pan, gate = 1 |</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s15">var</span> audio, env;</p>
<p class="p15"><span class="s1"><span class="Apple-tab-span">	</span>audio = </span><span class="s15">Mix</span><span class="s1">.ar(</span><span class="s15">Pulse</span><span class="s1">.ar(freq, 0.5));<span class="Apple-tab-span">	</span></span>// this is a mixture of three oscillators</p>
<p class="p9"><span class="Apple-tab-span">	</span>env = <span class="s15">Linen</span>.kr(gate, susLevel: amp , doneAction: 2);<span class="Apple-converted-space">  </span><span class="s16">// envelope deletes the synt when done</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>audio = audio * env;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s15">OffsetOut</span>.ar(0, audio );</p>
<p class="p9">}).store</p>
<p class="p9">);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p4">Within an event, arrayed arguments of this sort must be enclosed within an additional array to distinguish them from arguments intended for multi-channel expansion.</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p15">// one synth, use enclosing array to prevent multi-channel expansion</p>
<p class="p9">(instrument: <span class="s14">\test</span>, note: [[0, 2, 4]]).play</p>
<p class="p8"><br></p>
<p class="p15">// two synths</p>
<p class="p9">(instrument: <span class="s14">\test</span>, note: [[0, 2, 4], [6, 8, 10]]).play</p>
<p class="p2"><br></p>
<p class="p10"><b>Events and Patterns</b></p>
<p class="p11"><br></p>
<p class="p16">Events are closely integrated with the Patterns library.<span class="Apple-converted-space">  </span>Different patterns can be bound to different keys (or collections of keys) to specify the resultant music.<span class="Apple-converted-space">  </span><span class="s1">See the help<span class="Apple-converted-space">  </span>files <a href="../Streams-Patterns-Events/Pattern.html"><span class="s3"><b>Pattern</b></span></a><b> </b>and <a href="../Streams-Patterns-Events/Pbind.html"><span class="s3"><b>Pbind</b></span></a><b> </b>and the tutorials<span class="Apple-converted-space">  </span><a href="../Streams-Patterns-Events/Streams-Patterns-Events4.html"><span class="s3"><b>Streams-Patterns-Events4</b></span></a> and <a href="../Streams-Patterns-Events/Streams-Patterns-Events5.html"><span class="s3"><b>Streams-Patterns-Events5</b></span></a><b> </b>for more details on Patterns.</span></p>
<p class="p2"><br></p>
<p class="p16">Here is an example that illustrates some of the keys defined by the defaultParentEvent.</p>
<p class="p16">Note that it is equivalent to write <b>Pbind(\key, val, ...)</b> and <b>Pbind(*[key: val, ...])</b>.</p>
<p class="p2"><br></p>
<p class="p9">(</p>
<p class="p9">p = <span class="s9">Pbind</span>(*[</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>stepsPerOctave:<span class="Apple-tab-span">	</span><span class="s9">Pstep</span>(<span class="s9">Pseq</span>((2..12).mirror, <span class="s9">inf</span>),12), <span class="s12">// 3 - 12 tone e.t. scales</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>note:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Pseq</span>((0..12).mirror, <span class="s9">inf</span>),</p>
<p class="p8"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ctranspose:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Pwhite</span>(-0.2, 0.2),<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// detune up to +-20 cents</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>detune:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Pwhite</span>(-1.0, 1.0),<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// detune up to 1 Hz<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sustain:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Prand</span>([0.2, 0.2, 0.2, 4], <span class="s9">inf</span>), <span class="Apple-tab-span">	</span><span class="s12">// notes last 0.2 or 4 seconds</span></p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// 1 in 6 chance note lasts 0.8 seconds</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dur:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Prand</span>([0.2, 0.2, 0.2, 0.2, 0.2, 0.8], <span class="s9">inf</span>),</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>db:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s9">Pstep</span><span class="s1">(<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// 4 beat accent structure</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">Pseq</span>([-15, -25, -20, -25], <span class="s9">inf</span>),<span class="Apple-converted-space"> </span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.8</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p9"><span class="Apple-tab-span">	</span>]);</p>
<p class="p9"><span class="Apple-tab-span">	</span>p.play<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9">)<span class="Apple-tab-span">	</span></p>
<p class="p5"><br></p>
<p class="p10"><b>Event's play method</b></p>
<p class="p2"><br></p>
<p class="p4">When an Event<span class="Apple-converted-space">  </span>(or any other <a href="Environment.html"><span class="s6">Environment</span></a>) receives a <span class="s4">use(function)</span> message, it sets itself to be currentEnvironment, evaluates the function, and restores the original value of currentEnvironment. This allows the function to access and alter the contents of the event using the following shortcuts:</p>
<p class="p2"><br></p>
<p class="p17"><span class="s17"><span class="Apple-tab-span">	</span></span>~keyName<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s17">which is equivalent to<span class="Apple-tab-span">	</span></span>currentEnvironment.at(keyName)</p>
<p class="p4">and</p>
<p class="p17"><span class="s17"><span class="Apple-tab-span">	</span></span>~keyName = value<span class="Apple-tab-span">	</span><span class="s17">which is equivalent to<span class="Apple-tab-span">	</span></span>currentEnvironment.put(keyName, value)</p>
<p class="p6"><br></p>
<p class="p4">We will write ~keyName whenever referring to the value stored at the key keyName in the event. <span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p4">Here is the definition of Event's play method:</p>
<p class="p2"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>play {</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (parent.isNil) { parent = defaultParentEvent };</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s18">this</span>.use { ~play.value };</p>
<p class="p9"><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><br></p>
<p class="p4">Thus we can see that the defaultParentEvent is used unless otherwise specified and the function stored in <span class="s4">~play </span>is executed in the context of the Event.</p>
<p class="p5"><br></p>
<p class="p10"><b>Timing control with Event's delta method</b></p>
<p class="p2"><br></p>
<p class="p4">Events also specify timing within a <a href="../Streams-Patterns-Events/Pattern.html"><span class="s6">Pattern</span></a>.<span class="Apple-converted-space">  </span>Event's <span class="s4">delta </span>method returns the<span class="Apple-converted-space">  </span>value of <span class="s4">~delta </span>or, if that is nil,<span class="Apple-converted-space">  </span><span class="s4">~dur * ~stretch.<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><br></p>
<p class="p4">Patterns are played by<b> </b><a href="../Scheduling/TempoClock.html"><span class="s6">TempoClock</span></a>s, which have their own tempo controls.<span class="Apple-converted-space">  </span>This tempo which can be controlled through <span class="s4">~tempo </span>in the event. Changes to the tempo affect everything else scheduled by the TempoClock, so <span class="s4">tempo </span>provides a global tempo control while <span class="s4">stretch </span>provides a control limited to the one pattern.</p>
<p class="p5"><br></p>
<p class="p10"><b>The structure of defaultParentEvent</b></p>
<p class="p5"><br></p>
<p class="p4">The default parent event provides the collection of default values and functions needed for the different uses of an Event. These<span class="Apple-converted-space">  </span>defaults are defined in partialEvents that specify distinct aspects of default parent Event:<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>playerEvent<span class="Apple-tab-span">	</span></b>defines ~play, ~type and ~eventTypes</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>serverEvent<span class="Apple-tab-span">	</span></b>server, group, addAction</p>
<p class="p4"><span class="Apple-tab-span">	</span><b>durEvent<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>duration, tempo and articulation</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>ampEvent<span class="Apple-tab-span">	</span></b>volume, pan, MIDI velocity</p>
<p class="p4"><span class="Apple-tab-span">	</span><b>pitchEvent<span class="Apple-tab-span">	</span></b>pitch specified in many different ways</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>bufferEvent<span class="Apple-tab-span">	</span></b>buffers on the server</p>
<p class="p4"><b><span class="Apple-tab-span">	</span>midiEvent<span class="Apple-tab-span">	</span></b>midi</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p10"><b>Useful keys for notes</b></p>
<p class="p2"><br></p>
<p class="p4">Using Events is largely a matter of overwriting keys.<span class="Apple-converted-space">  </span>Here is a list of keys useful for defining notes with their default values, grouped by the partialEvent within which they are defined.</p>
<p class="p2"><br></p>
<p class="p4">The keys in serverEvent provide the values needed to identify the server to be used and where in the tree</p>
<p class="p4">of nodes to place the group. <span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p4"><b>serverEvent keys</b>:</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>server: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s9">nil</span><span class="s1">,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// if nil, Server.default is used</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>instrument: <span class="Apple-tab-span">	</span></span><span class="s8">\default</span><span class="s1">,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// this is the name of a SynthDef</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>group: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>1,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// nodeID of group on the server</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// whening adding before or after a node</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// this could be the nodeID of a synth instead of a group</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>addAction:<span class="Apple-tab-span">	</span>0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// 0, 1, 2, 3 or \addToHead, \addToTail, \addBefore, \addAfter</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>out: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// usually an output bus number, but depends on the SynthDef<span class="Apple-tab-span">	</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p4">The ampEvent determines volume.<span class="Apple-converted-space">  </span>Notice that <span class="s4">~amp</span> is a function that determines its value from <span class="s4">~db</span>. The user can choose to specify the amplitude directly by overwriting ~amp or to use a decibel specification by overwriting <span class="s4">~db</span>.</p>
<p class="p8"><br></p>
<p class="p4"><b>ampEvent keys</b>:</p>
<p class="p9"><span class="Apple-tab-span">	</span>amp: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>#{ ~db.dbamp },</p>
<p class="p9"><span class="Apple-tab-span">	</span>db: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-20.0,</p>
<p class="p9"><span class="Apple-tab-span">	</span>pan: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.0,<span class="Apple-converted-space"> <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p2"><br></p>
<p class="p4">The durEvent has keys that determine the timing of a note. Notice that <span class="s4">~sustain </span>is a function that uses ~legato to determine the sustain. Like <span class="s4">~amp </span>this can be overwritten to set the sustain directly.</p>
<p class="p2"><br></p>
<p class="p4"><b>durEvent keys</b>:</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>tempo:<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s9">nil</span><span class="s1">,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// changes tempo of a TempoClock</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>dur: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>1.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// delay until next note</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>stretch: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>1.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// inverse of tempo control, specific to the Event's stream</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>legato: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.8,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// ratio of sustain to duration</p>
<p class="p9"><span class="Apple-tab-span">	</span>sustain: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>#{ ~dur * ~legato * ~stretch },<span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>lag: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// delay relative to current time position of Stream</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>strum: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.0<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// "breaks" a chord</p>
<p class="p2"><br></p>
<p class="p4">The pitchEvent has the most complex system of functions that provide a variety of useful ways to determine</p>
<p class="p4">pitch:</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~freq<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>determines the pitch directly as a frequency in Hertz</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~midinote<span class="Apple-tab-span">	</span></span>determines pitch as a fractional MIDI note (69 -&gt; 440)</p>
<p class="p4"><span class="s4"><span class="Apple-tab-span">	</span>~note<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>determines pitch as a scale degree in an <span class="s4">~stepsPerOctave </span>equal tempered scale</p>
<p class="p4"><span class="s4"><span class="Apple-tab-span">	</span>~degree<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>determines pitch as a scale degree within the scale <span class="s4">~scale</span></p>
<p class="p2"><br></p>
<p class="p4">The event also provides a set of transposition keys:</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~mtranspose<span class="Apple-tab-span">	</span></span>modal transposition of degree within a scale</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~root</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>transposes root of the scale<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~gtranspose<span class="Apple-tab-span">	</span></span>gamut transposition within the<span class="s4">~stepsPerOctave</span> equal tempered scale</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~ctranspose<span class="Apple-tab-span">	</span></span>chromatic transposition within the 12 tone equal tempered scale</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~harmonic<span class="Apple-tab-span">	</span></span>multiplies the frequency determined by <span class="s4">~midinote</span>, typically to an overtone</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~detune</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>directly offsets frequency by adding this value</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">~midiToCps</span><span class="Apple-tab-span">	</span>a function taking a MIDI note number and turning it into frequency</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Normally this is _.midicps, but you can override it for non-ET tunings</p>
<p class="p2"><br></p>
<p class="p4"><b>pitchEvent keys:</b></p>
<p class="p8"><br></p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>mtranspose: <span class="Apple-tab-span">	</span>0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// modal transposition of degree</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>gtranspose: <span class="Apple-tab-span">	</span>0.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// gamut transposition of note within a ~stepsPerOctave e.t. scale</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>ctranspose: <span class="Apple-tab-span">	</span>0.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// chromatic transposition of midinote within 12 tone e.t. scale</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>octave: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>5.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// octave offest of note</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>root: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// root of the scale</p>
<p class="p13"><span class="s1"><span class="Apple-tab-span">	</span>degree: <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// degree in scale</p>
<p class="p9"><span class="Apple-tab-span">	</span>scale: #[0, 2, 4, 5, 7, 9, 11], <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// diatonic major scale</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>stepsPerOctave: 12.0,</p>
<p class="p9"><span class="Apple-tab-span">	</span>detune: 0.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// detune in Hertz</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>harmonic: 1.0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s12">// harmonic ratio</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>note: #{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(~degree + ~mtranspose).degreeToKey(~scale, ~stepsPerOctave);</p>
<p class="p9"><span class="Apple-tab-span">	</span>},</p>
<p class="p9"><span class="Apple-tab-span">	</span>midinote: #{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>((~note.value + ~gtranspose + ~root) / ~stepsPerOctave + ~octave) * 12.0;<span class="Apple-converted-space"> </span></p>
<p class="p9"><span class="Apple-tab-span">	</span>},</p>
<p class="p9"><span class="Apple-tab-span">	</span>freq: #{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(~midinote.value + ~ctranspose).midicps * ~harmonic;</p>
<p class="p9"><span class="Apple-tab-span">	</span>},</p>
<p class="p2"><br></p>
<p class="p10"><b>Event types</b></p>
<p class="p2"><br></p>
<p class="p4">An Event responds to a play message by evaluating ~play in the event, which by default uses the event's type to define the action to be performed. See <a href="Event_types.html"><span class="s19">Event_types</span></a>.</p>
<p class="p2"><br></p>
</body>
</html>
