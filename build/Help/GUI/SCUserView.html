<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.42">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0018e8}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #4f432c}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #564329; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #594129}
p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #564329}
p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #263a97}
p.p13 {margin: 0.0px 0.0px 0.0px 10.0px; font: 9.0px Monaco}
p.p14 {margin: 0.0px 0.0px 0.0px 10.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p15 {margin: 0.0px 0.0px 0.0px 10.0px; font: 9.0px Monaco; color: #263a97}
span.s1 {font: 18.0px Helvetica}
span.s2 {color: #263a97}
span.s3 {color: #000000}
span.s4 {text-decoration: underline}
span.s5 {color: #606060}
span.s6 {color: #1e359d}
span.s7 {color: #62613a}
span.s8 {color: #0f2caa}
span.s9 {color: #0626af}
span.s10 {color: #556824}
span.s11 {color: #1832a2}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><span class="s1"><b>SCUserView<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></span><b>user-definable view</b></p>
<p class="p2"><br></p>
<p class="p3"><b>superclass: </b><span class="s2"><b>SCView</b></span></p>
<p class="p2"><br></p>
<p class="p3">SCUserView is a user-definable View intended mainly for use with Pen and drawHooks.</p>
<p class="p2"><br></p>
<p class="p4"><span class="s3">Se</span><span class="s2">e</span><span class="s3"> also: <a href="SCWindow.html"><span class="s4">SCWindow</span></a>, <a href="Pen.html"><span class="s4">Pen</span></a><b>, </b><a href="Color.html"><span class="s4">Color</span></a>, and <a href="../Collections/String.html"><span class="s4">String</span></a></span></p>
<p class="p2"><br></p>
<p class="p3"><b>keyDownAction_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the function which should be evaluated if the view is in focus and a key is pressed. This function will be passed four arguments: the View, the key pressed as a Char, modifier keys (shift, alt, etc.), and the unicode value. Se<span class="s2">e</span> <a href="SCView.html"><span class="s2">SCView</span></a> for more details.</p>
<p class="p2"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span>(</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span></span>// select the window, type something and watch the post window</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w = </span><span class="s2">SCWindow</span><span class="s3">.new(</span>"select this window and type something"<span class="s3">);</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c = <span class="s2">SCUserView</span>(w,w.view.bounds);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.keyDownAction = { <span class="s2">arg</span> view,char,modifiers,unicode;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[char, modifiers, unicode].postln;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.drawFunc = {|me|</p>
<p class="p8"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>char.asString.drawAtPoint(180@150, <span class="s2">Font</span>(<span class="s5">"Helvetica"</span>, 70), <span class="s2">Color</span>.blue(0.3, 0.5))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.refresh;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w.front; c.focus;</p>
<p class="p5"><span class="Apple-tab-span">	</span>)</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><b>drawFunc_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the function which should be evaluated if the view is refreshed. This happens every time the view or the whole window is refreshed (manually by calling SCView:refresh, SCWindow:refresh or e.g. by selecting the view or resizing the window).</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s2">var</span> func;</p>
<p class="p9"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>func = {<span class="s2">|me|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.use{</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// clipping into the boundingbox</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.moveTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@0));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@me.bounds.height));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (0@me.bounds.height));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.clip;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// draw background</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Color</span>.gray(0.5).set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.moveTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@0));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@me.bounds.height));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (0@me.bounds.height));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.lineTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.fill;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s6">Pen</span>.translate(100, 100);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.perform([<span class="s7">\stroke</span>, <span class="s7">\fill</span>].choose);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><br></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>w = </span><span class="s2">SCWindow</span><span class="s3">.new(</span>"DrawFunc Examples"<span class="s3">).front;</span></p>
<p class="p11"><span class="Apple-tab-span">	</span>w.view.background_(Color.white);</p>
<p class="p5"><span class="Apple-tab-span">	</span>3.do{<span class="s2">|i|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s2">SCUserView</span>(w, <span class="s2">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.drawFunc = func;</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p5"><span class="Apple-tab-span">	</span>)</p>
<p class="p2"><br></p>
<p class="p3"><b>relativeOrigin_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the Origin of Pen in the view's drawFunc relative to the SCUserView.</p>
<p class="p2"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span>(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s2">var</span> func;</p>
<p class="p9"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>func = {<span class="s2">|me|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.use{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.perform([<span class="s7">\stroke</span>, <span class="s7">\fill</span>].choose);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><br></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>w = </span><span class="s2">SCWindow</span><span class="s3">.new(</span>"DrawFunc Examples"<span class="s3">).front;</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>w.view.background_(<span class="s8">Color</span>.white);</p>
<p class="p5"><span class="Apple-tab-span">	</span>3.do{<span class="s2">|i|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s2">SCUserView</span>(w, <span class="s2">Rect</span>(20+(i*120), 100, 100, 100))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_(func).relativeOrigin_(true);</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p5"><span class="Apple-tab-span">	</span>)</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><b>mousePosition</b></p>
<p class="p2"><b></b><br></p>
<p class="p3">Get the relative position of the mouse cursor.</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><b>mouseDownAction_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the function which should be evaluated if the mouse is at the beginning of tracking (mouse-down). This function will be passed four arguments: theView, x coordinate, y coordinate, and keyboard modifiers.</p>
<p class="p2"><br></p>
<p class="p3"><b>mouseMoveAction_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the function which should be evaluated if the mouse is tracked. This function will be passed four arguments: theView, x coordinate, y coordinate, and keyboard modifiers.</p>
<p class="p2"><br></p>
<p class="p3"><b>mouseUpAction_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the function which should be evaluated if the mouse is at the end of tracking (mouse-up). This function will be passed four arguments: theView, x coordinate, y coordinate, and keyboard modifiers.</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s2">var</span> drawFunc, beginTrackFunc, endTrackFunc, trackFunc, sat = 0, absX;</p>
<p class="p9"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>drawFunc = {<span class="s2">|me|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.use{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.perform([<span class="s7">\stroke</span>, <span class="s7">\fill</span>].choose);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>beginTrackFunc = {<span class="s2">|me, x, y, mod|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>absX = x;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>postf(<span class="s5">"begin path: x=% realtive </span>mousePosition<span class="s5">:%\n"</span>,absX, me.mousePosition);</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>endTrackFunc = {<span class="s2">|me, x, y, mod|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>postf(<span class="s5">"end path: (absX-x)==% realtive </span>mousePosition<span class="s5">:%\n"</span>,(absX-x), me.mousePosition);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p12"><span class="s3"><span class="Apple-tab-span">	</span>trackFunc = {</span>|me, x, y, mod|</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sat = ((absX-x)/100);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>((me.mousePosition)/(me.bounds.width@me.bounds.height)).postln;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>me.refresh;</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span>w = <span class="s2">SCWindow</span>.new.front;</p>
<p class="p5"><span class="Apple-tab-span">	</span>w.view.background_(<span class="s2">Color</span>.white);</p>
<p class="p5"><span class="Apple-tab-span">	</span>3.do{<span class="s2">|i|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s2">SCUserView</span>(w, <span class="s2">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p6"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//v.background_(Color.white); // not affecting anything...</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.drawFunc = drawFunc;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseDownAction = beginTrackFunc;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseUpAction = endTrackFunc;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseMoveAction = trackFunc;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.relativeOrigin = true;</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p5"><span class="Apple-tab-span">	</span>)</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p6">// draw on the view</p>
<p class="p9"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>(</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="s2">var</span> w, txt, tmppoints, all;</p>
<p class="p13"><span class="Apple-tab-span">	</span>tmppoints = [];</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>w = <span class="s2">SCWindow</span>(<span class="s5">"draw on me"</span>, <span class="s2">Rect</span>(128, 64, 340, 360));</p>
<p class="p14"><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>v = </span>SCUserView<span class="s3">(w,</span>w.view.bounds<span class="s3">)</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseMoveAction_({<span class="s2">|v,x,y|</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[x,y].postln;</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = tmppoints.add(v.mousePosition);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p13"><span class="Apple-tab-span">	</span>})</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseUpAction_({<span class="s2">|v,x,y|</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all = all.add(tmppoints.copy);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = [];</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p13"><span class="Apple-tab-span">	</span>})</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_{|me|</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.use {<span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.white.set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.fillRect(me.bounds.moveTo(0,0));<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.width = 1;</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.black.set;</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.beginPath;</p>
<p class="p14"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints.do{<span class="Apple-tab-span">	</span><span class="s2">|p, i|</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.moveTo(p);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.lineTo(p);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all.do{<span class="s2">|points|</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>points.do{<span class="s2">|p, i|</span></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.moveTo(p);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.lineTo(p);</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.stroke;</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};<span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>v.relativeOrigin = true;</p>
<p class="p14"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p13"><span class="Apple-tab-span">	</span>)</p>
<p class="p14"><br></p>
<p class="p3"><b>clearOnRefresh_</b></p>
<p class="p2"><br></p>
<p class="p3">Set the behaviour for refreshing the view. If this flag is true (the default) the view will be cleared before each refresh call, otherwise It will draw in top of it. On OSX this functionality is only available for the version &gt;= 10.4<span class="Apple-converted-space">  </span>and with the flag relativeOrigin set to true.</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s9">var</span> width = 640, height = 480, w, theta = 0, drawFunc, gui;</p>
<p class="p5"><span class="Apple-tab-span">	</span>gui = <span class="s9">GUI</span>.get( <span class="s10">\cocoa</span> );</p>
<p class="p5"><span class="Apple-tab-span">	</span>w = gui.window.new( <span class="s5">"clearOnRefresh = true"</span>, <span class="s9">Rect</span>( 128, 64, width, height ), <span class="s9">false</span> );</p>
<p class="p5"><span class="Apple-tab-span">	</span>drawFunc = { <span class="s9">arg</span> view;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">var</span> x = 20 * sin( theta ), y = 42 * cos( theta );</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.addRect( view.bounds.moveTo( 0, 0 ));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.clip;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theta = theta + 0.01;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.fillColor_( <span class="s9">Color</span>.red( 0.2, 0.1 ));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.fillRect( <span class="s9">Rect</span>( 0, 0, width, height ));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.strokeColor_( <span class="s9">Color</span>.white );</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.translate( width * 0.5, height * 0.5 );</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6.do { <span class="s9">arg</span> i;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.rotate( theta * (1 - (i / 6)) );</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.scale( 0.7 + (i * 0.4), 0.4 + (i * 0.5) );</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.strokeOval( <span class="s9">Rect</span>.aboutPoint( <span class="s9">Point</span>( x, y ), 60, 40 ));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span>x = gui.userView.new( w, <span class="s9">Rect</span>( 10, 10, width - 20, height - 20 ))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.canFocus_( <span class="s9">false</span> )</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_( drawFunc )</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.clearOnRefresh_( <span class="s9">false</span> )</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.relativeOrigin_( <span class="s9">true</span> );</p>
<p class="p9"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s9">Routine</span>({ while({ x.isClosed.not }, { x.refresh; (1/25).wait })}).play( <span class="s9">AppClock</span> );</p>
<p class="p5">)</p>
<p class="p9"><br></p>
<p class="p5">(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s11">var</span> width= 640, height= 480, w, theta= 0, drawFunc;</p>
<p class="p5"><span class="Apple-tab-span">	</span>w= <span class="s11">GUI</span>.window.new(<span class="s5">"trail test3"</span>, <span class="s11">Rect</span>(128, 64, width, height), <span class="s11">false</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span>drawFunc= {<span class="s11">|v|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">var</span> x= 20*sin(theta), y= 42*cos(theta);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theta= theta+0.01;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.fillColor_(<span class="s11">Color</span>.red(0.2, 0.1));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.fillRect(<span class="s11">Rect</span>(0, 0, width, height));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.strokeColor_(<span class="s11">Color</span>.white);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.push;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.translate(width*0.5, height*0.5);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6.do{<span class="s11">|i|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.rotate(theta*(1-(i/6)));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.scale(0.7+(i*0.4), 0.4+(i*0.5));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.strokeOval(<span class="s11">Rect</span>.aboutPoint(<span class="s11">Point</span>(x, y), 60, 40))</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.pen.pop;</p>
<p class="p5"><span class="Apple-tab-span">	</span>};</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s11">GUI</span>.userView.new(w, <span class="s11">Rect</span>(10, 10, width-20, height-20)).drawFunc_(drawFunc).relativeOrigin_(true);</p>
<p class="p5"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s11">Routine</span>({<span class="s11">inf</span>.do{<span class="s11">|i|</span> w.refresh; (1/25).wait}}).play(<span class="s11">AppClock</span>);</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p5">prevent redrawing:</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5"><span class="s2">var</span> func, views;</p>
<p class="p9"><br></p>
<p class="p5">func = {<span class="s2">|me|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.use{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Pen</span>.perform([<span class="s7">\stroke</span>, <span class="s7">\fill</span>].choose);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">};</p>
<p class="p9"><br></p>
<p class="p7"><span class="s3">w = </span><span class="s2">SCWindow</span><span class="s3">.new(</span>"DrawFunc Examples"<span class="s3">).front;</span></p>
<p class="p11">w.view.background_(Color.white);</p>
<p class="p5">views = {|i|</p>
<p class="p5"><span class="Apple-tab-span">	</span>v = <span class="s2">SCUserView</span>(w, <span class="s2">Rect</span>(20+(i*120), 100, 100, 100)).relativeOrigin_(true);</p>
<p class="p5"><span class="Apple-tab-span">	</span>v.drawFunc = func;</p>
<p class="p5">} ! 3;</p>
<p class="p5">w.refresh;</p>
<p class="p5">{views.do{|v| v.clearOnRefresh_(false);v.drawFunc = nil}}.defer(0.4);</p>
<p class="p5">)</p>
</body>
</html>
