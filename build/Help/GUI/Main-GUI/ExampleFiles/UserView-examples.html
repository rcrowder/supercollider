<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.43">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica}
p.p6 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
span.s1 {text-decoration: underline ; color: #001ee6}
span.s2 {color: #0020f6}
span.s3 {color: #0000bf}
span.s4 {color: #000000}
span.s5 {color: #007300}
span.s6 {color: #606060}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>Creation / Class Methods</b></p>
<p class="p2"><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>*new (parent, bounds)</b></p>
<p class="p4"><br></p>
<p class="p5"><b>Examples</b></p>
<p class="p6"><br></p>
<p class="p3"><span class="s1"><a href="../../GUI-Overview.html">GUI-Overview</a></span> contains an elobarate example on how to make a gui widget with UserView using interface level coding. For a Tutorial on how to write a subclass of SCUserView to make your own custom GUI Widgets, see <a href="../../Cocoa-GUI/SCUserViewSubclassing/SCUserView-Subclassing.html"><span class="s2">SCUserView-Subclassing</span></a></p>
<p class="p6"><br></p>
<p class="p7">// Basic Usage. Resize the window to refresh the drawing. Or use mouse click.</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9">w=<span class="s3">Window</span>.new;</p>
<p class="p9">v=<span class="s3">UserView</span>(w, w.view.bounds.insetBy(50,50));</p>
<p class="p9">v.background_(<span class="s3">Color</span>.rand);</p>
<p class="p9">v.relativeOrigin=<span class="s3">true</span>;</p>
<p class="p9">v.drawFunc={<span class="s3">|uview|</span></p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.moveTo(0@uview.bounds.height.rand);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(uview.bounds.width@uview.bounds.height.rand);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.stroke;</p>
<p class="p9"><span class="Apple-tab-span">	</span>};</p>
<p class="p9">v.mouseDownAction={v.refresh};</p>
<p class="p9">w.front;</p>
<p class="p8"><br></p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// A More complicated drawing function.</p>
<p class="p7">// Resize the window to refresh the drawing</p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> func;</p>
<p class="p8"><br></p>
<p class="p9">func = {<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.use{</p>
<p class="p7"><span class="s4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// clipping into the boundingbox</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.moveTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@0));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@me.bounds.height));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (0@me.bounds.height));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.clip;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="s4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// draw background</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.gray(0.5).set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.moveTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@0));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (me.bounds.width@me.bounds.height));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(((me.bounds.left)@(me.bounds.top))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>+ (0@me.bounds.height));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo((me.bounds.left)@(me.bounds.top));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.fill;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p8"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.translate(100, 100);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.perform([<span class="s5">\stroke</span>, <span class="s5">\fill</span>].choose);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span>}</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p10"><span class="s4">w = </span><span class="s3">Window</span><span class="s4">.new(</span>"DrawFunc Examples"<span class="s4">).front;</span></p>
<p class="p9">w.view.background_(<span class="s3">Color</span>.white);</p>
<p class="p9">3.do{<span class="s3">|i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>v = <span class="s3">UserView</span>(w, <span class="s3">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.drawFunc = func;</p>
<p class="p9">};</p>
<p class="p9">w.refresh;</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Use Relative Coordinates</p>
<p class="p7">// Set the Origin of Pen in the view's drawFunc relative to the UserView.</p>
<p class="p7">// This is particularly useful if resize is set in such a way the the position of the user view changes.</p>
<p class="p7">// Try resizing the Window.</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> func;</p>
<p class="p8"><br></p>
<p class="p9">func = {<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.use{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.perform([<span class="s5">\stroke</span>, <span class="s5">\fill</span>].choose);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span>}</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p10"><span class="s4">w = </span><span class="s3">Window</span><span class="s4">.new(</span>"DrawFunc Examples"<span class="s4">).front;</span></p>
<p class="p9">w.view.background_(<span class="s3">Color</span>.white);</p>
<p class="p8"><br></p>
<p class="p9">3.do{<span class="s3">|i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>v = <span class="s3">UserView</span>(w, <span class="s3">Rect</span>(20+(i*120), 100, 100, 100))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_(func).relativeOrigin_(<span class="s3">true</span>);</p>
<p class="p7"><span class="s4"><span class="Apple-tab-span">	</span>v.resize=3; </span>// the func coordinates ar valid even though the view move on resize</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.background_(<span class="s3">Color</span>.rand);</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p9">w.refresh;</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Mouse Tracking</p>
<p class="p7">// Set the function which should be evaluated if the mouse is at the end of tracking (mouse-up).</p>
<p class="p7">// This function will be passed four arguments: theView, x coordinate, y coordinate, and keyboard modifiers.</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> drawFunc, mouseDownFunc, mouseUpFunc, mouseMoveFunc, sat = 0, absX;</p>
<p class="p8"><br></p>
<p class="p9">drawFunc = {<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.use{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.perform([<span class="s5">\stroke</span>, <span class="s5">\fill</span>].choose);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span>}</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p9">mouseDownFunc = {<span class="s3">|me, x, y, mod|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>absX = x;</p>
<p class="p10"><span class="s4"><span class="Apple-tab-span">	</span>postf(</span>"begin path: x=% realtive mousePosition:%\n"<span class="s4">,absX, me.mousePosition);</span></p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p9">mouseUpFunc = {<span class="s3">|me, x, y, mod|</span></p>
<p class="p10"><span class="s4"><span class="Apple-tab-span">	</span>postf(</span>"end path: (absX-x)==% realtive mousePosition:%\n"<span class="s4">,(absX-x), me.mousePosition);</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p9">mouseMoveFunc = {<span class="s3">|me, x, y, mod|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>sat = ((absX-x)/100);</p>
<p class="p9"><span class="Apple-tab-span">	</span>((me.mousePosition)/(me.bounds.width@me.bounds.height)).postln;</p>
<p class="p9"><span class="Apple-tab-span">	</span>me.refresh;</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p9">w = <span class="s3">Window</span>.new.front;</p>
<p class="p9">w.view.background_(<span class="s3">Color</span>.white);</p>
<p class="p9">3.do{<span class="s3">|i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>v = <span class="s3">UserView</span>(w, <span class="s3">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.background_(<span class="s3">Color</span>.rand);</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.drawFunc = drawFunc;</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.mouseDownAction = mouseDownFunc;</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.mouseUpAction = mouseUpFunc;</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.mouseMoveAction = mouseMoveFunc;</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.relativeOrigin = <span class="s3">true</span>;</p>
<p class="p9">};</p>
<p class="p9">w.refresh;</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Use the mouse to draw on the view</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> w, txt, tmppoints, all;</p>
<p class="p9">tmppoints = [];</p>
<p class="p8"><br></p>
<p class="p9">w = <span class="s3">Window</span>(<span class="s6">"draw on me"</span>, <span class="s3">Rect</span>(128, 64, 340, 360));</p>
<p class="p8"><br></p>
<p class="p9">v = <span class="s3">UserView</span>(w,w.view.bounds)</p>
<p class="p9"><span class="Apple-tab-span">	</span>.mouseMoveAction_({<span class="s3">|v,x,y|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[x,y].postln;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = tmppoints.add(v.mousePosition);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p9">})</p>
<p class="p9"><span class="Apple-tab-span">	</span>.mouseUpAction_({<span class="s3">|v,x,y|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all = all.add(tmppoints.copy);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = [];</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p9">})</p>
<p class="p9"><span class="Apple-tab-span">	</span>.drawFunc_{<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.use {<span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.white.set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.fillRect(me.bounds.moveTo(0,0));<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.width = 1;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.black.set;</p>
<p class="p8"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.beginPath;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints.do{<span class="Apple-tab-span">	</span><span class="s3">|p, i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.moveTo(p);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(p);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all.do{<span class="s3">|points|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>points.do{<span class="s3">|p, i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.moveTo(p);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.lineTo(p);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.stroke;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span>};<span class="Apple-tab-span">	</span></p>
<p class="p9">v.relativeOrigin = <span class="s3">true</span>;</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9">w.front;</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Clearing on Refresh</p>
<p class="p7">//</p>
<p class="p7">// Set the behaviour for refreshing the view.</p>
<p class="p7">// If this flag is true (the default) the view will be cleared before each refresh call,</p>
<p class="p7">// otherwise It will draw in top of it.</p>
<p class="p7">// On OSX this functionality is only available for the version &gt;= 10.4 and with the flag relativeOrigin set to true.</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">var</span> width = 640, height = 480, w, theta = 0, drawFunc, gui;</p>
<p class="p9"><span class="Apple-tab-span">	</span>gui = <span class="s3">GUI</span>.get( <span class="s5">\cocoa</span> );</p>
<p class="p9"><span class="Apple-tab-span">	</span>w = gui.window.new( <span class="s6">"clearOnRefresh = true"</span>, <span class="s3">Rect</span>( 128, 64, width, height ), <span class="s3">false</span> );</p>
<p class="p9"><span class="Apple-tab-span">	</span>drawFunc = { <span class="s3">arg</span> view;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">var</span> x = 20 * sin( theta ), y = 42 * cos( theta );</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.addRect( view.bounds.moveTo( 0, 0 ));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.clip;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theta = theta + 0.01;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.fillColor_( <span class="s3">Color</span>.red( 0.2, 0.1 ));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.fillRect( <span class="s3">Rect</span>( 0, 0, width, height ));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.strokeColor_( <span class="s3">Color</span>.white );</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.translate( width * 0.5, height * 0.5 );</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6.do { <span class="s3">arg</span> i;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.rotate( theta * (1 - (i / 6)) );</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.scale( 0.7 + (i * 0.4), 0.4 + (i * 0.5) );</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gui.pen.strokeOval( <span class="s3">Rect</span>.aboutPoint( <span class="s3">Point</span>( x, y ), 60, 40 ));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span>x = gui.userView.new( w, <span class="s3">Rect</span>( 10, 10, width - 20, height - 20 ))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.canFocus_( <span class="s3">false</span> )</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_( drawFunc )</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.clearOnRefresh_( <span class="s3">false</span> )</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.relativeOrigin_( <span class="s3">true</span> );</p>
<p class="p8"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Routine</span>({ while({ x.isClosed.not }, { x.refresh; (1/25).wait })}).play( <span class="s3">AppClock</span> );</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">var</span> width= 640, height= 480, w, theta= 0, drawFunc;</p>
<p class="p9"><span class="Apple-tab-span">	</span>w= <span class="s3">GUI</span>.window.new(<span class="s6">"trail test3"</span>, <span class="s3">Rect</span>(128, 64, width, height), <span class="s3">false</span>);</p>
<p class="p9"><span class="Apple-tab-span">	</span>drawFunc= {<span class="s3">|v|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">var</span> x= 20*sin(theta), y= 42*cos(theta);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theta= theta+0.01;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.fillColor_(<span class="s3">Color</span>.red(0.2, 0.1));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.fillRect(<span class="s3">Rect</span>(0, 0, width, height));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.strokeColor_(<span class="s3">Color</span>.white);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.push;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.translate(width*0.5, height*0.5);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6.do{<span class="s3">|i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.rotate(theta*(1-(i/6)));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.scale(0.7+(i*0.4), 0.4+(i*0.5));</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.strokeOval(<span class="s3">Rect</span>.aboutPoint(<span class="s3">Point</span>(x, y), 60, 40))</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.pen.pop;</p>
<p class="p9"><span class="Apple-tab-span">	</span>};</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">GUI</span>.userView.new(w, <span class="s3">Rect</span>(10, 10, width-20, height-20)).drawFunc_(drawFunc).relativeOrigin_(<span class="s3">true</span>);</p>
<p class="p9"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Routine</span>({<span class="s3">inf</span>.do{<span class="s3">|i|</span> w.refresh; (1/25).wait}}).play(<span class="s3">AppClock</span>);</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Prevent redrawing:</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> func, views;</p>
<p class="p8"><br></p>
<p class="p9">func = {<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.use{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.perform([<span class="s5">\stroke</span>, <span class="s5">\fill</span>].choose);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p9"><span class="Apple-tab-span">	</span>}</p>
<p class="p9">};</p>
<p class="p8"><br></p>
<p class="p10"><span class="s4">w = </span><span class="s3">Window</span><span class="s4">.new(</span>"DrawFunc Examples"<span class="s4">).front;</span></p>
<p class="p9">w.view.background_(<span class="s3">Color</span>.white);</p>
<p class="p9">views = {<span class="s3">|i|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span>v = <span class="s3">UserView</span>(w, <span class="s3">Rect</span>(20+(i*120), 100, 100, 100)).relativeOrigin_(<span class="s3">true</span>);</p>
<p class="p9"><span class="Apple-tab-span">	</span>v.drawFunc = func;</p>
<p class="p9">} ! 3;</p>
<p class="p9">w.refresh;</p>
<p class="p9">{views.do{<span class="s3">|v|</span> v.clearOnRefresh_(<span class="s3">false</span>);v.drawFunc = <span class="s3">nil</span>}}.defer(0.4);</p>
<p class="p9">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">// Use refreshInRect(aRect).</p>
<p class="p7">// Constrains the receiver's refresh area to the rectangle passed in aRect.</p>
<p class="p7">// you may use Quartz Debug's flash screen updates to see the refresh area of the view</p>
<p class="p8"><br></p>
<p class="p9">(</p>
<p class="p9"><span class="s3">var</span> userView, win, blob = <span class="s3">Rect</span>(0, 0, 50, 50), trackblob=<span class="s3">false</span>, pmouse;</p>
<p class="p8"><br></p>
<p class="p10"><span class="s4">a = </span><span class="s3">Image</span><span class="s4">.new(</span>"/Library/Desktop Pictures/Ripples Blue.jpg"<span class="s4">);</span></p>
<p class="p8"><br></p>
<p class="p9">win = <span class="s3">Window</span>.new(<span class="s6">"refreshInRect Test"</span>, <span class="s3">Rect</span>(400, 400, 600, 200), scroll:<span class="s3">true</span>).front;</p>
<p class="p9">win.onClose_({ a.free; });</p>
<p class="p8"><br></p>
<p class="p9">userView = <span class="s3">UserView</span>(win, <span class="s3">Rect</span>(10,10,2000,800))</p>
<p class="p9"><span class="Apple-tab-span">	</span>.backgroundImage_(a, 5)</p>
<p class="p9"><span class="Apple-tab-span">	</span>.relativeOrigin_(<span class="s3">false</span>)</p>
<p class="p9"><span class="Apple-tab-span">	</span>.drawFunc_({<span class="s3">|me|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Color</span>.blue.setFill;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">Pen</span>.fillRect(blob);</p>
<p class="p9"><span class="Apple-tab-span">	</span>})</p>
<p class="p9"><span class="Apple-tab-span">	</span>.mouseDownAction_({<span class="s3">|v, x, y, mod|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>pmouse = x@y;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>trackblob = blob.containsPoint(pmouse);</p>
<p class="p9"><span class="Apple-tab-span">	</span>})</p>
<p class="p9"><span class="Apple-tab-span">	</span>.mouseUpAction_({<span class="s3">|v, x, y, mod|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>trackblob = <span class="s3">false</span>;</p>
<p class="p9"><span class="Apple-tab-span">	</span>})</p>
<p class="p9"><span class="Apple-tab-span">	</span>.mouseMoveAction_({<span class="s3">|v, x, y, mod|</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">var</span> refresh, mouse, delta;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouse = x@y;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(trackblob, {</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>refresh = blob.copy;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delta = mouse-pmouse;</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>blob = blob.moveBy(delta.x, delta.y);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>refresh = refresh.union(blob);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refreshInRect(refresh);</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>pmouse = mouse;</p>
<p class="p9"><span class="Apple-tab-span">	</span>});</p>
<p class="p8"><br></p>
<p class="p9">blob = blob.moveBy(userView.bounds.left, userView.bounds.top);</p>
<p class="p9">userView.bounds.postln;</p>
<p class="p9">)</p>
<p class="p8"><br></p>
</body>
</html>
