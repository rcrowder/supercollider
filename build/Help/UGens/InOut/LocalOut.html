<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.44">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #091fb1; min-height: 12.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 14.0px; text-indent: -14.0px; font: 12.0px Helvetica}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0016e6}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
span.s1 {font: 18.0px Helvetica}
span.s2 {color: #000000}
span.s3 {text-decoration: underline}
span.s4 {color: #0000bf}
span.s5 {color: #bf0000}
span.s6 {color: #606060}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><span class="s1"><b>LocalOut</b></span><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>write to buses local to a synth</b></p>
<p class="p2"><br></p>
<p class="p3"><b>superclass: AbstractOut</b></p>
<p class="p2"><br></p>
<p class="p3"><b>*ar(channelsArray) </b>- write a signal to an audio bus local to the enclosing synth.</p>
<p class="p3"><b>*kr(channelsArray) </b>-<b> </b>write a signal to a control bus local to the enclosing synth.</p>
<p class="p4"><br></p>
<p class="p5"><b>channelsArray </b>- an Array of channels or single output to write out. You cannot change the size of this once a SynthDef has been built.</p>
<p class="p2"><br></p>
<p class="p3"><b>LocalOut</b> writes to buses that are local to the enclosing synth. The buses should have been defined by a <b>LocalIn</b> ugen. The <b>channelsArray</b> must be the same number of channels as were declared in the LocalIn. These are like the global buses, but are more convenient if you want to implement a self contained effect that uses a feedback processing loop.</p>
<p class="p6"><span class="s2">See <a href="LocalIn.html"><span class="s3">LocalIn</span></a>.</span></p>
<p class="p4"><br></p>
<p class="p3"><b>N.B.</b> Audio written to a LocalOut will not be read by a corresponding <b>LocalIn</b> until the next cycle, i.e. one block size of samples later. Because of this it is important to take this additional delay into account when using LocalIn to create feedback delays with delay times shorter than the threshold of pitch (i.e. &lt; 0.05 seconds or &gt; 20Hz), or where sample accurate alignment is required. See the resonator example below.</p>
<p class="p4"><br></p>
<p class="p7">(</p>
<p class="p7">{</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">var</span> source, local;</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>source = <span class="s4">Decay</span>.ar(<span class="s4">Impulse</span>.ar(0.3), 0.1) * <span class="s4">WhiteNoise</span>.ar(0.2);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">LocalIn</span>.ar(2) + [source, 0]; <span class="s5">// read feedback, add to source</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">DelayN</span>.ar(local, 0.2, 0.2); <span class="s5">// delay sound</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="s2"><span class="Apple-tab-span">	</span></span>// reverse channels to give ping pong effect, apply decay factor</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">LocalOut</span>.ar(local.reverse * 0.8);<span class="Apple-converted-space"> </span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">Out</span>.ar(0, local);</p>
<p class="p7">}.play;</p>
<p class="p7">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">(</p>
<p class="p7">z = <span class="s4">SynthDef</span>(<span class="s6">"tank"</span>, {</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">var</span> local, in;</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>in = <span class="s4">Mix</span>.fill(12, {<span class="Apple-converted-space"> </span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">Pan2</span>.ar(</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">Decay2</span>.ar(<span class="s4">Dust</span>.ar(0.05), 0.1, 0.5, 0.1)<span class="Apple-converted-space"> </span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>* <span class="s4">FSinOsc</span>.ar(<span class="s4">IRand</span>(36,84).midicps).cubed.max(0),<span class="Apple-converted-space"> </span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">Rand</span>(-1,1))</p>
<p class="p7"><span class="Apple-tab-span">	</span>});</p>
<p class="p7"><span class="Apple-tab-span">	</span>in = in + <span class="s4">Pan2</span>.ar(<span class="s4">Decay2</span>.ar(<span class="s4">Dust</span>.ar(0.03), 0.04, 0.3) * <span class="s4">BrownNoise</span>.ar, 0);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>4.do { in = <span class="s4">AllpassN</span>.ar(in, 0.03, {<span class="s4">Rand</span>(0.005,0.02)}.dup, 1); };</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">LocalIn</span>.ar(2) * 0.98;</p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">OnePole</span>.ar(local, 0.5);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">Rotate2</span>.ar(local[0], local[1], 0.23);</p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">AllpassN</span>.ar(local, 0.05, {<span class="s4">Rand</span>(0.01,0.05)}.dup, 2);</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-converted-space"> <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">DelayN</span>.ar(local, 0.3, [0.19,0.26]);</p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">AllpassN</span>.ar(local, 0.05, {<span class="s4">Rand</span>(0.03,0.15)}.dup, 2);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">LeakDC</span>.ar(local);<span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = local + in;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">LocalOut</span>.ar(local);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">Out</span>.ar(0, local);</p>
<p class="p7">}).play;</p>
<p class="p7">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">(</p>
<p class="p7">z = <span class="s4">SynthDef</span>(<span class="s6">"tape"</span>, {</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">var</span> local, in, amp;</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>in = <span class="s4">SoundIn</span>.ar([0,1]);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>amp = <span class="s4">Amplitude</span>.kr(<span class="s4">Mix</span>.ar(in));</p>
<p class="p7"><span class="Apple-tab-span">	</span>in = in * (amp &gt; 0.02); <span class="s5">// noise gate</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">LocalIn</span>.ar(2);</p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">OnePole</span>.ar(local, 0.4);</p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">OnePole</span>.ar(local, -0.08);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">Rotate2</span>.ar(local[0], local[1], 0.2);</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-converted-space"> <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">DelayN</span>.ar(local, 0.25, 0.25);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = <span class="s4">LeakDC</span>.ar(local);<span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span>local = ((local + in) * 1.25).softclip;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">LocalOut</span>.ar(local);</p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="s4">Out</span>.ar(0, local * 0.1);</p>
<p class="p7">}).play;</p>
<p class="p7">)</p>
<p class="p8"><br></p>
<p class="p9">// Resonator, must subtract blockSize for correct tuning</p>
<p class="p7">(</p>
<p class="p7"><span class="s4">var</span> play, imp, initial;</p>
<p class="p10"><span class="s4">SynthDef</span><span class="s2">(</span>"testRes"<span class="s2">, {</span></p>
<p class="p8"><br></p>
<p class="p7">play = <span class="s4">LocalIn</span>.ar(1);<span class="Apple-converted-space"> </span></p>
<p class="p7">imp = <span class="s4">Impulse</span>.ar(1);</p>
<p class="p8"><br></p>
<p class="p7"><span class="s4">LocalOut</span>.ar(<span class="s4">DelayC</span>.ar(imp + (play * 0.995), 1, 440.reciprocal - <span class="s4">ControlRate</span>.ir.reciprocal)); <span class="s5">// for feedback</span></p>
<p class="p8"><br></p>
<p class="p7"><span class="s4">OffsetOut</span>.ar(0, play);</p>
<p class="p8"><br></p>
<p class="p7">}).play(s);</p>
<p class="p8"><br></p>
<p class="p7">{<span class="s4">SinOsc</span>.ar(440, 0, 0.2) }.play(s, 1); <span class="s5">// compare pitch</span></p>
<p class="p7">)</p>
</body>
</html>
