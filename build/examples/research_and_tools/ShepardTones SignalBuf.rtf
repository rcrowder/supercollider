{\rtf1\mac\ansicpg10000\cocoartf824\cocoasubrtf440
{\fonttbl\f0\fnil\fcharset77 Monaco;}
{\colortbl;\red255\green255\blue255;\red191\green0\blue0;\red0\green0\blue191;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\f0\fs18 \cf0 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural
\cf2 // shepard tones\
// alberto de campo\cf0 \
(\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural
\cf3 var\cf0  ampTable, freqTable, b1, b2;\
\
ampTable = \cf3 Signal\cf0 .hanningWindow(1024).squared;\
freqTable = \cf3 Signal\cf0 .newClear(1024).waveFill(\{ \cf3 arg\cf0  i; 0.5 ** i * 20000 \}, 0, 10);\
\
b1 = \cf3 Buffer\cf0 .loadCollection(s, freqTable);\
b2 = \cf3 Buffer\cf0 .loadCollection(s, ampTable);\
\
\{\
	\cf3 var\cf0  freqs, amps, phasor, ratescale, rate, phases;\
	ratescale = 1024 / 44100 / 10;\
	rate = 0.1;	\cf2 // once per 10 sec\cf0 \
	phasor = \cf3 Phasor\cf0 .ar(0, rate * ratescale, 0, 1024);\
	phases = (0..9) * 0.1 * 1024 + phasor;\
\
	freqs = \cf3 BufRd\cf0 .ar(1, b1.bufnum, phases);\
	amps = \cf3 BufRd\cf0 .ar(1, b2.bufnum, phases);\
\
	\cf3 Mix\cf0 .ar(\cf3 SinOsc\cf0 .ar(freqs) * amps) * 0.1;\
\}.play;\
\
)}